name: Brahmavidya Sleep Saver

on:
  push:
    branches: [ main ]

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - uses: actions/setup-node@v3
        with: { node-version: 16 }
          
      - run: npm install -g cordova
      
      # ðŸ”¥ FIX 1: Java 17 (à¤¹à¥‡ Android 12 à¤¸à¤¾à¤ à¥€ à¤…à¤¨à¤¿à¤µà¤¾à¤°à¥à¤¯ à¤†à¤¹à¥‡ à¤†à¤£à¤¿ Gradle à¤à¤°à¤° à¤•à¤¾à¤¢à¤¤à¥‡)
      - uses: actions/setup-java@v3
        with: { distribution: 'temurin', java-version: '17' }

      # --- STEP 1: à¤ªà¥à¤°à¥‹à¤œà¥‡à¤•à¥à¤Ÿ à¤¤à¤¯à¤¾à¤° à¤•à¤°à¤£à¥‡ ---
      - name: Create Project
        run: |
          # App ID OK
          cordova create myapp com.brahmavidya.app "Brahmavidya"
          cd myapp
          
          # ðŸ”¥ FIX 2: Android 12.0.0 (à¤¹à¥‡ Java 17 à¤¸à¥‹à¤¬à¤¤ à¤²à¥‹à¤£à¥à¤¯à¤¾à¤¸à¤¾à¤°à¤–à¥‡ à¤šà¤¾à¤²à¤¤à¥‡)
          # (à¤†à¤§à¥€ à¤¹à¥‡ à¤«à¥‡à¤² à¤à¤¾à¤²à¥‡ à¤¹à¥‹à¤¤à¥‡ à¤•à¤¾à¤°à¤£ à¤«à¥‹à¤Ÿà¥‹ à¤–à¤°à¤¾à¤¬ à¤¹à¥‹à¤¤à¥‡, à¤†à¤¤à¤¾ à¤†à¤ªà¤£ à¤«à¥‹à¤Ÿà¥‹ à¤«à¤¿à¤•à¥à¤¸ à¤•à¥‡à¤²à¥‡ à¤†à¤¹à¥‡à¤¤)
          cordova platform add android@12.0.0
          
          cordova plugin add cordova-plugin-statusbar
          cordova plugin add cordova-plugin-device
          cd ..

      # --- STEP 2: à¤®à¥…à¤œà¤¿à¤• à¤‡à¤®à¥‡à¤œ (Resource Error à¤«à¤¿à¤•à¥à¤¸) ---
      - name: Generate Safe Assets
        run: |
          echo "Generating magic assets..."
          
          # 1. à¤•à¥à¤²à¥€à¤¨à¤…à¤ª
          rm myapp/www/index.html myapp/www/css/index.css myapp/www/js/index.js
          
          # 2. à¤•à¥‹à¤¡ à¤•à¥‰à¤ªà¥€
          cp index.html myapp/www/
          cp *.html myapp/www/ || true
          cp *.js myapp/www/ || true
          cp *.css myapp/www/ || true

          # 3. ðŸ”¥ MAGIC IMAGE (à¤²à¤¾à¤² à¤¬à¥‰à¤•à¥à¤¸) - Resource Error à¤¯à¥‡à¤£à¤¾à¤°à¤š à¤¨à¤¾à¤¹à¥€ ðŸ”¥
          echo "iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mP8z8BQDwAEhQGAhKmMIQAAAABJRU5ErkJggg==" | base64 -d > safe_img.png
          
          # 4. à¤«à¥‹à¤Ÿà¥‹ à¤¸à¥‡à¤Ÿ à¤•à¤°à¤£à¥‡
          cp safe_img.png myapp/www/logo.png
          cp safe_img.png myapp/www/login_bg.png
          cp safe_img.png myapp/www/cover.jpg
          cp safe_img.png myapp/www/photo1.jpg
          cp safe_img.png myapp/www/photo2.jpg
          
          # 5. à¤²à¤¿à¤¸à¥à¤Ÿ à¤¬à¤¨à¤µà¤£à¥‡
          cd myapp/www
          echo "var autoBookList = [" > filelist.js
          for f in *.html; do
            if [ "$f" != "index.html" ]; then
              baseName=$(basename "$f" .html)
              echo "{ name: '$baseName', file: '$f', image: 'cover.
